# PowerPoint 템플릿 제작 가이드

지역화 교육 플랫폼에서 사용할 PowerPoint 템플릿을 제작하는 방법을 안내합니다.

## 📌 Placeholder 형식

템플릿에서 동적으로 치환될 부분은 **대괄호 형식**을 사용합니다:

```
[PLACEHOLDER_NAME]
```

### ✅ 올바른 예시

```
[REGION_NAME]의 여러 장소를 알아봅시다
[SCHOOL_NAME] 수업자료
생성일: [DATE]
```

### ❌ 잘못된 예시

```
{{지역명}}  ← 구형 방식 (지원하지만 권장하지 않음)
{REGION_NAME}  ← 중괄호 1개는 인식 안 됨
<REGION_NAME>  ← 꺾쇠는 XML과 충돌
```

## 📝 사용 가능한 Placeholder 목록

### 기본 Placeholder

| Placeholder | 설명 | 예시 값 |
|------------|------|---------|
| `[REGION_NAME]` | 사용자가 선택한 지역명 | 청송군, 강남구 |
| `[SCHOOL_NAME]` | 사용자가 입력한 학교명 | 청송초등학교 |
| `[TEMPLATE_TITLE]` | 템플릿 제목 | 지역의 여러장소 알아보기 |
| `[DATE]` | PPT 생성 날짜 | 2025. 11. 2. |

### 장소 관련 Placeholder (향후 지원 예정)

| Placeholder | 설명 |
|------------|------|
| `[NATURAL_SITE_1]` | 자연 명소 1 이름 |
| `[NATURAL_SITE_2]` | 자연 명소 2 이름 |
| `[NATURAL_SITE_1_DESC]` | 자연 명소 1 설명 |
| `[NATURAL_SITE_1_IMAGE]` | 자연 명소 1 이미지 (자동 삽입) |
| `[EDU_SITE_1]` | 교육 관련 장소 1 이름 |
| `[EDU_SITE_2]` | 교육 관련 장소 2 이름 |
| `[HISTORICAL_SITE_1]` | 역사 유적지 1 이름 |
| `[TRANSIT_HUB_1]` | 교통 중심지 1 이름 |
| `[MARKETPLACE_1]` | 시장/상업지 1 이름 |
| `[RECREATION_AREA_1]` | 문화/여가 장소 1 이름 |

## 🎨 템플릿 제작 모범 사례

### 1. Placeholder 입력 시 주의사항

✅ **권장 방법:**
- PowerPoint에서 한 번에 타이핑하기: `[REGION_NAME]`
- 복사-붙여넣기 사용하기
- 단축키 설정하여 빠르게 입력

❌ **피해야 할 방법:**
- 여러 번 나누어 입력 (예: `[REGION` 입력 후 다른 작업 후 `_NAME]` 입력)
- 중간에 서식 변경 (예: `[REGION`만 볼드 처리)
- Placeholder 일부를 다른 텍스트 박스에 분리

### 2. 텍스트 서식

```
[REGION_NAME]의 여러 장소
```

- ✅ 전체를 동일한 서식으로 설정
- ✅ 단락 전체를 한 번에 볼드/이탤릭 처리
- ❌ Placeholder만 부분적으로 서식 변경하지 않기

### 3. 슬라이드 구조

```
슬라이드 1 (표지):
  제목: [REGION_NAME]의 여러 장소를 알아봅시다
  부제: [SCHOOL_NAME] / [DATE]

슬라이드 2 (자연 명소):
  제목: [REGION_NAME]의 자연 명소
  내용:
    - [NATURAL_SITE_1]
    - [NATURAL_SITE_2]
  이미지: [NATURAL_SITE_1_IMAGE]

슬라이드 3 (교육 장소):
  제목: [REGION_NAME]의 교육 관련 장소
  ...
```

## 🔧 Placeholder 동작 원리

시스템이 자동으로:

1. **텍스트 추출**: PowerPoint XML에서 모든 텍스트를 추출
2. **Placeholder 탐지**: `[...]` 형식의 패턴을 찾음
3. **값 치환**: 실제 데이터로 교체
4. **재조립**: 수정된 내용으로 PPTX 파일 생성

## 📤 템플릿 업로드 방법

1. 관리자 모드에서 로그인
2. "템플릿 관리" 메뉴 선택
3. "새 템플릿 업로드" 클릭
4. PPTX 파일 선택 및 메타데이터 입력
5. 업로드 완료

## 🧪 템플릿 테스트

업로드 후 반드시 테스트:

1. 교사 모드로 전환
2. 테스트 지역 선택 (예: "테스트시")
3. 템플릿으로 PPT 생성
4. 다운로드하여 확인:
   - ✅ 모든 Placeholder가 치환되었는지
   - ✅ 서식이 유지되는지
   - ✅ 이미지가 올바르게 삽입되었는지

## 💡 문제 해결

### Placeholder가 치환되지 않을 때

**증상**: `[REGION_NAME]` 그대로 표시됨

**원인**:
1. PowerPoint가 텍스트를 여러 부분으로 분리
2. Placeholder 오타 (예: `[REGION_NMAE]`)
3. 대소문자 불일치 (예: `[region_name]`)

**해결방법**:
1. Placeholder를 삭제하고 다시 한 번에 입력
2. 복사-붙여넣기 사용
3. 대소문자 정확히 입력

### 일부만 치환될 때

**원인**: XML 파싱 문제

**해결방법**:
1. 해당 텍스트 박스의 모든 내용을 삭제
2. 다시 한 번에 입력
3. 서식을 나중에 적용

## 📋 체크리스트

템플릿 제작 완료 전 확인:

- [ ] 모든 Placeholder가 `[PLACEHOLDER_NAME]` 형식인가?
- [ ] Placeholder 철자가 정확한가?
- [ ] 대소문자가 올바른가?
- [ ] 각 Placeholder가 한 번에 입력되었는가?
- [ ] 테스트 생성으로 확인했는가?
- [ ] 모든 슬라이드를 확인했는가?

## 🆘 지원

문제가 발생하면:
- GitHub Issues에 문의
- 에러 로그와 함께 템플릿 파일 첨부

---

**버전**: 1.0
**최종 업데이트**: 2025-11-02
